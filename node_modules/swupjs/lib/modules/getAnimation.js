'use strict';

module.exports = function (transition, animations, type) {

    var animation = null;
    var animationName = null;
    var topRating = 0;

    Object.keys(animations).forEach(function (item) {
        var rating = 0;
        if (item.includes('>')) {
            var route = item.split('>');
            var from = route[0];
            var to = route[1];

            // TO equals to TO
            if (to == transition.to || to == "*") {
                rating++;
            }

            // equals to CUSTOM animation
            if (to == transition.custom) {
                rating = rating + 2;
            }

            // FROM equals or is ANY
            if (from == transition.from || from == "*") {
                rating++;
            }
        }

        // set new final animation
        if (rating > topRating) {
            topRating = rating;
            animationName = item;
            animation = animations[item];
        }
    });

    if (animation == null || topRating == 1) {
        animation = animations['*'];
        animationName = '*';
    }

    return animation[type];
};